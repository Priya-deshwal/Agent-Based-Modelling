<pre><font color="#007f69">globals</font><font color="#000000"> [<br />  num           </font><font color="#5a5a5a">; number of agents</font><font color="#000000"><br />  </font><font color="#5a5a5a">;;s             ; environment size in meters</font><font color="#000000"><br />  rad           </font><font color="#5a5a5a">; collision radius</font><font color="#000000"><br />  sight         </font><font color="#5a5a5a">; neighbor search range</font><font color="#000000"><br />  maxF          </font><font color="#5a5a5a">; maximum force/acceleration</font><font color="#000000"><br />  circles       </font><font color="#5a5a5a">; list of agent turtles</font><font color="#000000"><br />  v             </font><font color="#5a5a5a">; list of agent velocities</font><font color="#000000"><br />  gv            </font><font color="#5a5a5a">; list of agent goal velocities</font><font color="#000000"><br />  nbr           </font><font color="#5a5a5a">; list of agent neighbor lists</font><font color="#000000"><br />  nd            </font><font color="#5a5a5a">; list of agent neighbor distance lists</font><font color="#000000"><br /> </font><font color="#5a5a5a">;  listvelocity;</font><font color="#000000"><br />  yo</font><font color="#5a5a5a">;</font><font color="#000000"><br />  zo</font><font color="#5a5a5a">;</font><font color="#000000"><br />  listgv</font><font color="#5a5a5a">;</font><font color="#000000"><br />  he</font><font color="#5a5a5a">;</font><font color="#000000"><br />  te</font><font color="#5a5a5a">;</font><font color="#000000"><br />  r<br />  rx<br />  ry<br />]<br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> num </font><font color="#963700">18</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> rad </font><font color="#963700">0.2</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> sight </font><font color="#963700">7</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> maxF </font><font color="#963700">999</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> r []<br />  </font><font color="#0000aa">set</font><font color="#000000"> v []<br />  </font><font color="#0000aa">set</font><font color="#000000"> gv []<br />  </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#660096">max-pxcor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#660096">max-pycor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">create-turtles</font><font color="#000000"> num [<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;circle&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> i </font><font color="#660096">random-float</font><font color="#000000"> j<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">360</font><font color="#000000"><br />   </font><font color="#5a5a5a">; set listvelocity[];</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> rx [</font><font color="#660096">pxcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> ry [</font><font color="#660096">pycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> yo </font><font color="#963700">1.5</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> (</font><font color="#963700">0</font><font color="#000000">) (heading-to-vector </font><font color="#660096">heading</font><font color="#000000">))<br />    </font><font color="#0000aa">set</font><font color="#000000"> zo </font><font color="#963700">1.5</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000">) (heading-to-vector </font><font color="#660096">heading</font><font color="#000000">))<br />    </font><font color="#0000aa">let</font><font color="#000000"> vo (</font><font color="#660096">list</font><font color="#000000"> yo zo)<br />    </font><font color="#0000aa">set</font><font color="#000000"> he </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> (</font><font color="#963700">0</font><font color="#000000">) (heading-to-vector </font><font color="#660096">heading</font><font color="#000000">))<br />    </font><font color="#0000aa">set</font><font color="#000000"> te </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000">) (heading-to-vector </font><font color="#660096">heading</font><font color="#000000">))<br />    </font><font color="#0000aa">let</font><font color="#000000"> gvo (</font><font color="#660096">list</font><font color="#000000"> he te)<br />    </font><font color="#0000aa">let</font><font color="#000000"> ro (</font><font color="#660096">list</font><font color="#000000"> rx ry)<br />    </font><font color="#0000aa">print</font><font color="#000000"> ro<br />    </font><font color="#0000aa">print</font><font color="#000000"> vo<br />    </font><font color="#0000aa">print</font><font color="#000000"> gvo<br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> (</font><font color="#660096">who</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"> ] [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000"> ]<br />    </font><font color="#0000aa">let</font><font color="#000000"> r1 </font><font color="#660096">lput</font><font color="#000000"> ro r<br />    </font><font color="#0000aa">let</font><font color="#000000"> v1 </font><font color="#660096">lput</font><font color="#000000"> vo v<br />    </font><font color="#0000aa">let</font><font color="#000000"> gv1 </font><font color="#660096">lput</font><font color="#000000"> gvo gv<br />    </font><font color="#0000aa">set</font><font color="#000000"> r r1<br />    </font><font color="#0000aa">set</font><font color="#000000"> v v1<br />    </font><font color="#0000aa">set</font><font color="#000000"> gv gv1<br />  ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> circles </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> r <br />  </font><font color="#0000aa">print</font><font color="#000000"> v<br />  </font><font color="#0000aa">print</font><font color="#000000"> gv<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> heading-to-vector [angle]<br />  </font><font color="#0000aa">let</font><font color="#000000"> x-component </font><font color="#660096">sin</font><font color="#000000"> angle </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1.0</font><font color="#000000">  </font><font color="#5a5a5a">; Multiply by desired magnitude</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> y-component </font><font color="#660096">cos</font><font color="#000000"> angle </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">-1.0</font><font color="#000000"> </font><font color="#5a5a5a">; Multiply by desired magnitude</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> x-component y-component)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> subtract [pa pb]<br />  </font><font color="#0000aa">let</font><font color="#000000"> p []<br />  </font><font color="#0000aa">let</font><font color="#000000"> xpb ( </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> pb)<br />  </font><font color="#0000aa">let</font><font color="#000000"> xpa ( </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> pa)<br />  </font><font color="#0000aa">let</font><font color="#000000"> xp xpb </font><font color="#660096">-</font><font color="#000000"> xpa <br />  </font><font color="#0000aa">let</font><font color="#000000"> ypb ( </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> pb)<br />  </font><font color="#0000aa">let</font><font color="#000000"> ypa ( </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> pa)<br />  </font><font color="#0000aa">let</font><font color="#000000"> yp ypb </font><font color="#660096">-</font><font color="#000000"> ypa <br />  </font><font color="#0000aa">set</font><font color="#000000"> p (</font><font color="#660096">list</font><font color="#000000"> xp yp)<br />  </font><font color="#0000aa">report</font><font color="#000000"> p<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> multiplyvector [pa pb]<br />  </font><font color="#5a5a5a">;let p []</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> x1 </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> pa<br />  </font><font color="#0000aa">let</font><font color="#000000"> x2 </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> pb<br />  </font><font color="#0000aa">let</font><font color="#000000"> y1 </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> pa<br />  </font><font color="#0000aa">let</font><font color="#000000"> y2 </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> pb<br />  </font><font color="#0000aa">let</font><font color="#000000"> p (x1 </font><font color="#660096">*</font><font color="#000000"> x2) </font><font color="#660096">+</font><font color="#000000"> (y1 </font><font color="#660096">*</font><font color="#000000"> y2)<br />  </font><font color="#0000aa">report</font><font color="#000000"> p<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> multiplyscalar [f a]<br />  </font><font color="#0000aa">let</font><font color="#000000"> h []<br />  </font><font color="#0000aa">let</font><font color="#000000"> f1 (</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> f) </font><font color="#660096">*</font><font color="#000000"> a<br />  </font><font color="#0000aa">let</font><font color="#000000"> f2 (</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> f) </font><font color="#660096">*</font><font color="#000000"> a<br />  </font><font color="#0000aa">set</font><font color="#000000"> h (</font><font color="#660096">list</font><font color="#000000"> f1 f2)<br />  </font><font color="#0000aa">report</font><font color="#000000"> h<br /></font><font color="#007f69">end</font><font color="#000000"><br />  <br /></font><font color="#007f69">to-report</font><font color="#000000"> dE [ pa pb va vb ra rb ]<br />  </font><font color="#0000aa">let</font><font color="#000000"> B </font><font color="#963700">1.5</font><font color="#000000">  </font><font color="#5a5a5a">; parameter</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> m </font><font color="#963700">2.0</font><font color="#000000">  </font><font color="#5a5a5a">; parameter</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> t0 </font><font color="#963700">3</font><font color="#000000">   </font><font color="#5a5a5a">; parameter</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> infty </font><font color="#963700">999</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> maxt </font><font color="#963700">999</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> p []<br />  </font><font color="#0000aa">set</font><font color="#000000"> p subtract pa pb<br />  </font><font color="#0000aa">let</font><font color="#000000"> u []<br />  </font><font color="#0000aa">set</font><font color="#000000"> u subtract vb va<br />  </font><font color="#0000aa">let</font><font color="#000000"> radius ra </font><font color="#660096">+</font><font color="#000000"> rb<br />  </font><font color="#0000aa">let</font><font color="#000000"> px </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> p<br />  </font><font color="#0000aa">let</font><font color="#000000"> py </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> p<br />  </font><font color="#0000aa">let</font><font color="#000000"> dist </font><font color="#660096">sqrt</font><font color="#000000"> (px </font><font color="#660096">^</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> py </font><font color="#660096">^</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)<br />  </font><font color="#0000aa">if</font><font color="#000000"> (radius </font><font color="#660096">&gt;</font><font color="#000000"> dist) [</font><font color="#0000aa">set</font><font color="#000000"> radius </font><font color="#963700">0.99</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> dist]<br />  </font><font color="#0000aa">let</font><font color="#000000"> a multiplyvector u u <br />  </font><font color="#0000aa">let</font><font color="#000000"> d multiplyvector p u<br />  </font><font color="#0000aa">let</font><font color="#000000"> j multiplyvector p p<br />  </font><font color="#0000aa">let</font><font color="#000000"> c j </font><font color="#660096">-</font><font color="#000000"> radius </font><font color="#660096">*</font><font color="#000000"> radius<br />  </font><font color="#0000aa">let</font><font color="#000000"> discr d </font><font color="#660096">*</font><font color="#000000"> d </font><font color="#660096">-</font><font color="#000000"> a </font><font color="#660096">*</font><font color="#000000"> c<br />  </font><font color="#0000aa">if</font><font color="#000000"> (discr </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> (a </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">0.001</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> a </font><font color="#660096">&gt;</font><font color="#000000"> (</font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">0.001</font><font color="#000000">)) [ </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> discr </font><font color="#660096">sqrt</font><font color="#000000"> (discr)<br />  </font><font color="#0000aa">let</font><font color="#000000"> t1 (d </font><font color="#660096">-</font><font color="#000000"> discr) </font><font color="#660096">/</font><font color="#000000"> a<br />  </font><font color="#0000aa">let</font><font color="#000000"> t t1<br />  </font><font color="#0000aa">if</font><font color="#000000"> (t </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [</font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)]<br />  </font><font color="#0000aa">if</font><font color="#000000"> (t </font><font color="#660096">&gt;</font><font color="#000000"> maxt) [</font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)]<br />  </font><font color="#0000aa">let</font><font color="#000000"> g B </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">exp</font><font color="#000000">(</font><font color="#660096">-</font><font color="#000000"> t </font><font color="#660096">/</font><font color="#000000"> t0) </font><font color="#660096">*</font><font color="#000000"> (u </font><font color="#660096">-</font><font color="#000000"> (u </font><font color="#660096">*</font><font color="#000000"> d </font><font color="#660096">-</font><font color="#000000"> p </font><font color="#660096">*</font><font color="#000000"> a) </font><font color="#660096">/</font><font color="#000000"> (discr)) </font><font color="#660096">/</font><font color="#000000"> (a </font><font color="#660096">*</font><font color="#000000"> t </font><font color="#660096">^</font><font color="#000000"> m) </font><font color="#660096">*</font><font color="#000000"> (m </font><font color="#660096">/</font><font color="#000000"> t </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> t0)<br />  </font><font color="#0000aa">report</font><font color="#000000"> g<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> addscalar [f a]<br />  </font><font color="#0000aa">let</font><font color="#000000"> h []<br />  </font><font color="#0000aa">let</font><font color="#000000"> f1 </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> f <br />  </font><font color="#0000aa">let</font><font color="#000000"> h1 f1 </font><font color="#660096">+</font><font color="#000000"> a<br />  </font><font color="#0000aa">let</font><font color="#000000"> f2 </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> f<br />  </font><font color="#0000aa">let</font><font color="#000000"> h2 f2 </font><font color="#660096">+</font><font color="#000000"> a<br />  </font><font color="#0000aa">set</font><font color="#000000"> h (</font><font color="#660096">list</font><font color="#000000"> h1 h2)<br />  </font><font color="#0000aa">report</font><font color="#000000"> h<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> addvector [f a]<br />  </font><font color="#0000aa">let</font><font color="#000000"> h []<br />  </font><font color="#0000aa">let</font><font color="#000000"> f1 </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> f <br />  </font><font color="#0000aa">let</font><font color="#000000"> e1 </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> a<br />  </font><font color="#0000aa">let</font><font color="#000000"> f2 </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> f <br />  </font><font color="#0000aa">let</font><font color="#000000"> e2 </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> a<br />  </font><font color="#0000aa">let</font><font color="#000000"> h1 f1 </font><font color="#660096">+</font><font color="#000000"> e1<br />  </font><font color="#0000aa">let</font><font color="#000000"> h2 f2 </font><font color="#660096">+</font><font color="#000000"> e2<br />  </font><font color="#0000aa">set</font><font color="#000000"> h (</font><font color="#660096">list</font><font color="#000000"> h1 h2)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> updt [ dt ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> nbr []<br />  </font><font color="#0000aa">set</font><font color="#000000"> nd []<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    </font><font color="#0000aa">let</font><font color="#000000"> F (</font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> )<br />    </font><font color="#0000aa">set</font><font color="#000000"> nbr </font><font color="#660096">lput</font><font color="#000000"> [] nbr<br />    </font><font color="#0000aa">set</font><font color="#000000"> nd </font><font color="#660096">lput</font><font color="#000000"> [] nd<br />    </font><font color="#0000aa">let</font><font color="#000000"> this </font><font color="#660096">self</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> mx [</font><font color="#660096">pxcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this<br />    </font><font color="#0000aa">let</font><font color="#000000"> my [</font><font color="#660096">pycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> this<br />    </font><font color="#0000aa">let</font><font color="#000000"> pa (</font><font color="#660096">list</font><font color="#000000"> mx my) <br />    </font><font color="#0000aa">let</font><font color="#000000"> indx </font><font color="#660096">position</font><font color="#000000"> pa r<br />    </font><font color="#0000aa">print</font><font color="#000000"> pa<br />    </font><font color="#0000aa">print</font><font color="#000000"> indx<br />    </font><font color="#5a5a5a">;let turtles-positions map [t -&gt; list [pxcor] of t [pycor] of t] r</font><font color="#000000"><br />    </font><font color="#5a5a5a">;let turtle-position [pxcor] of self [pycor] of self</font><font color="#000000"><br />    </font><font color="#5a5a5a">;let indx position turtle-position turtles-positions</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> va </font><font color="#660096">item</font><font color="#000000"> indx v<br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />      </font><font color="#0000aa">let</font><font color="#000000"> other-turtle </font><font color="#660096">self</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> d </font><font color="#660096">distance</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> d </font><font color="#660096">&lt;=</font><font color="#000000"> sight [<br />        </font><font color="#0000aa">set</font><font color="#000000"> nbr </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> nbr<br />        </font><font color="#0000aa">set</font><font color="#000000"> nd </font><font color="#660096">lput</font><font color="#000000"> d nd<br />        </font><font color="#0000aa">let</font><font color="#000000"> nx [</font><font color="#660096">pxcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> other-turtle<br />        </font><font color="#0000aa">let</font><font color="#000000"> ny [</font><font color="#660096">pycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> other-turtle<br />        </font><font color="#0000aa">let</font><font color="#000000"> pb (</font><font color="#660096">list</font><font color="#000000"> nx ny)<br />        </font><font color="#0000aa">let</font><font color="#000000"> idx </font><font color="#660096">position</font><font color="#000000"> pb r<br />        </font><font color="#0000aa">let</font><font color="#000000"> vb </font><font color="#660096">item</font><font color="#000000"> idx v<br />        </font><font color="#0000aa">let</font><font color="#000000"> ra rad<br />        </font><font color="#0000aa">let</font><font color="#000000"> rb rad<br />        </font><font color="#0000aa">let</font><font color="#000000"> frc dE pa pb va vb ra rb<br />        </font><font color="#0000aa">set</font><font color="#000000"> F addscalar F frc<br />        </font><font color="#0000aa">set</font><font color="#000000"> nbr </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> nbr<br />        </font><font color="#0000aa">set</font><font color="#000000"> nd </font><font color="#660096">lput</font><font color="#000000"> d nd<br />      ]<br />    ]<br />   </font><font color="#0000aa">let</font><font color="#000000"> thisv va<br />   </font><font color="#0000aa">let</font><font color="#000000"> thisg </font><font color="#660096">item</font><font color="#000000"> indx gv<br />    </font><font color="#0000aa">let</font><font color="#000000"> k subtract thisv thisg<br />   </font><font color="#0000aa">set</font><font color="#000000"> F addvector F k<br />    </font><font color="#0000aa">let</font><font color="#000000"> z multiplyscalar F dt<br />   </font><font color="#0000aa">let</font><font color="#000000"> nextv addvector thisv z<br />   </font><font color="#0000aa">let</font><font color="#000000"> q multiplyscalar nextv dt<br />   </font><font color="#0000aa">let</font><font color="#000000"> nextp addvector pa q<br />    </font><font color="#5a5a5a">;if abs nextv &gt; maxF [set nextv maxF * (nextv / abs nextv)]</font><font color="#000000"><br />    </font><font color="#5a5a5a">;set thisv nextv</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> v2 </font><font color="#660096">replace-item</font><font color="#000000"> indx v nextv<br />    </font><font color="#0000aa">set</font><font color="#000000"> v v2<br />    </font><font color="#0000aa">set</font><font color="#000000"> this </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> (</font><font color="#963700">50</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (nextv </font><font color="#660096">-</font><font color="#000000"> thisv) </font><font color="#660096">/</font><font color="#000000"> maxF)<br />    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> nextp </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> nextp<br />    </font><font color="#0000aa">let</font><font color="#000000"> x3 </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> nextp<br />    </font><font color="#0000aa">let</font><font color="#000000"> y3 </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> nextp<br />    </font><font color="#0000aa">let</font><font color="#000000"> xy1 (</font><font color="#660096">list</font><font color="#000000"> x3 y3)<br />    </font><font color="#0000aa">let</font><font color="#000000"> r2 </font><font color="#660096">replace-item</font><font color="#000000"> indx r xy1<br />    </font><font color="#0000aa">set</font><font color="#000000"> r r2<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> go<br />   updt </font><font color="#963700">0.1</font><font color="#000000"><br />   </font><font color="#0000aa">tick</font><font color="#000000"><br /></font><font color="#007f69">end</font>
</pre>
